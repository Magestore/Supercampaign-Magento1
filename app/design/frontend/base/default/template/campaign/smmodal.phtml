<!--campaign/smmodal.phtml-->

<?php $popups = $this->getAllPopupAvailable(); ?>
<?php foreach($popups as $popup): ?>

<?php

    //zend_debug::dump($popup);die;

    //$popup->getData();
    Zend_debug::dump($popup->getData());
    $segmentpopup = Mage::helper('campaign')->checkSegmentpopup();
    $cookiepopup = Mage::helper('campaign')->checkCookiepopup();
    $stylepopup = Mage::helper('campaign')->checkStylepopup();
?>

<div class="<?php echo $popup->getPopupType() ?>">
    <div id="sc-popup<?php echo $popup->getData('template_code') ?>" class="modal fade sc-popup<?php echo $popup->getData('template_code') ?>" role="dialog">
        <div class="modal-dialog">
            <!-- Modal content-->
            <div class="modal-content">
                <a class="dialogClose style1 overlay2" data-dismiss="modal" data-target="#sc-popup<?php echo $popup->getData('template_code') ?>"></a>
                <?php echo $popup->getData('popup_content'); ?>
            </div>
        </div>
    </div>
</div>
<?php

    $style_plus ="";
    $border_color = "border-color:#".$popup->getData('border_color').";";
    $border_size = "border-width:".$popup->getData('border_size')."px;";
    $padding_size = "padding:".$popup->getData('padding')."px;";
    $position = $popup->getData('position_to');
    $position_px = $popup->getData('position_px');
    $position_to = "";
    if($position_px != " "){
        $position_to = $position.":".$position_px."px;";
    }
    $backgroundcolor = "background-color:#".$popup->getData('popup_background').";";

    $width = "";
    if($popup->getData('width') !=  "0" && $popup->getData('width') !=  ""){
        $width = "width:".$popup->getData('width')."px;";
    }
    $maxwidth = "";
    if($popup->getData('max_width') !=  ""){
        $maxwidth = "max-width:".$popup->getData('max_width')."px;";
    }

    $close_path = $popup->getData('close_icon_style');
    $close_icon = "";
    switch($close_path) {
        case 0:
            $close_icon = ".dialogClose{background:url(".$this->getSkinUrl('images/campaign/popup/close_white.png').") no-repeat 5px 5px}";
            break;
        case 1:
            $close_icon = ".dialogClose{background:url(".$this->getSkinUrl('images/campaign/popup/close_promotion.png').") no-repeat 5px -20px}";
            break;
        case 2:
            $close_icon = ".dialogClose{background:none transparent}";
            break;
    }

    $corner_style = $popup->getData('corner_style');
        switch($corner_style) {
            case 0:
            $style_plus = "border-radius:".$popup->getData('border_radius')."px;";
            break;
            case 1:
            $style_plus = "border-radius:0px;";
            break;
            case 2:
            $style_plus = "border-radius:50%;overflow:hidden;";
            break;
        }
    $stylecontent = "#sc-popup".$popup->getData('template_code')."  .modal-content{".$width." ".$backgroundcolor." ".$style_plus." ".$border_color." ".$border_size." ".$padding_size." ".$maxwidth."}";
    $styleoverbg = "#sc-popup".$popup->getData('template_code')."  .modal-backdrop{background-color:#".$popup->getData('overlay_color')."}";
    $styledialog = "#sc-popup".$popup->getData('template_code')."  .modal-dialog{".$position_to."}";
    $customcss = $popup->getData('custom_css');

?>
<script type="text/javascript">
    var $j = jQuery.noConflict();


    switch(<?php echo $popup->getData('appear_effect')?>) {
        case 0:
            $j('.modal').prop('class', 'modal fade').addClass('top');
            break;
        case 1:
            $j('.modal').prop('class', 'modal fade').addClass('left');
            break;
        case 2:
            $j('.modal').prop('class', 'modal fade').addClass('right');
            break;
        case 3:
            $j('.modal').prop('class', 'modal fade').addClass('bottom');
            break;
        case 4:
            $j('.modal').prop('class', 'modal fade').addClass('top-left');
            break;
        case 5:
            $j('.modal').prop('class', 'modal fade').addClass('top-right');
            break;
        case 6:
            $j('.modal').prop('class', 'modal fade').addClass('bottom-left');
            break;
        case 7:
            $j('.modal').prop('class', 'modal fade').addClass('bottom-right');
            break;
        default:
            $j('.modal').prop('class', 'modal fade').addClass('top');
    }
    $j(window).bind("load", function() {
        var string = "<style type=\"text/css\"><?php echo $stylecontent." ".$styledialog." ".$styleoverbg." ".$close_icon." ".$customcss?></style>"
        $j('head').append(string);
        $j('.modal').modal('show');
    });
</script>
<?php endforeach; ?>

